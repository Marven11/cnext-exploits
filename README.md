# CNEXT exploits

Exploits for CNEXT (CVE-2024-2961), a buffer overflow in the glibc's iconv(), by [@cfreal_](https://twitter.com/cfreal_)

Fork changes: support nixos, add test environment

## Reproduce steps

1. Enter `nix develop` and open a php environment in the `test_env` using `docker run --name php --net host -v $(pwd):/var/www/html php:7.4-apache` (pr replace `php:7.4-apache` with `20a3732f422b`)
2. run `python cnext-exploit.py 'http://127.0.0.1:80' 'ls /'` and you will see the result. 

## Usage

Rewrite `Remote` class in `cnext-exploit.py` based on what you need and use it.


# Technical analysis

The vulnerability and exploits are described in the following blogposts:

- [Iconv, set the charset to RCE: Exploiting the glibc to hack the PHP engine (part 1)](https://www.ambionics.io/blog/iconv-cve-2024-2961-p1): PHP filters
- [Iconv, set the charset to RCE: Exploiting the glibc to hack the PHP engine (part 2)](https://www.ambionics.io/blog/iconv-cve-2024-2961-p2): direct `iconv()` calls, Roundcube
- To be continued...

# Exploits

Exploits will become available as blogposts come out.

- [CNEXT: file read to RCE exploit](cnext-exploit.py)
- [Roundcube: authenticated RCE exploit](roundcube-exploit.py)
- To be continued...